% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reverseDecon.R
\name{reverseDecon}
\alias{reverseDecon}
\title{Reverse Deconvolution of Bulk Gene Expression}
\usage{
reverseDecon(norm, beta, epsilon = NULL)
}
\arguments{
\item{norm}{A numeric matrix of normalized gene expression
(genes × samples). Must be non-negative.}

\item{beta}{A numeric matrix of reference cell-type profiles
(cell types × samples). Row names must match the CTs to estimate.}

\item{epsilon}{Optional numeric. Lower bound applied before log-transform.
If \code{NULL}, automatically set to the 1st percentile of positive values in \code{norm}.}
}
\value{
A list with components:
\describe{
\item{coefs}{Matrix of model coefficients (intercept + CTs) per gene.}
\item{yhat}{Matrix of predicted gene expression.}
\item{resids}{Matrix of log-residuals.}
\item{cors}{Vector of per-gene correlations between observed and predicted expression.}
\item{resid.sd}{Vector of per-gene residual standard deviations.}
}
}
\description{
Performs reverse deconvolution of a normalized bulk gene expression matrix
given a cell-type reference profile matrix (\code{beta}).
The method fits log-normal linear models (\code{logNormReg::lognlm}) for each gene,
estimates per-cell-type contributions, reconstructs predicted bulk expression,
and computes residual diagnostics.
}
\details{
This function:
\enumerate{
\item Removes cell types with zero variance across samples.
\item Removes cell types that would be dropped due to linear dependence
(detected via an initial \code{lm()} call).
\item Fits log-normal regression using \pkg{logNormReg} for each gene.
\item Computes predicted bulk expression \eqn{\hat{Y}}.
\item Selects a reasonable \code{epsilon} for log-transform stability if not supplied.
\item Returns model coefficients, fitted values, residuals, correlations, and residual SD.
}
}
\examples{
\dontrun{
# norm:   gene × sample matrix
# beta:   CT × sample matrix

result <- reverseDecon(norm = norm, beta = beta)

head(result$coefs)
plot(result$cors)
}

}
