% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_bgindex.R
\name{calc_bgindex}
\alias{calc_bgindex}
\title{Calculate background-stability index for genes}
\usage{
calc_bgindex(
  exprs_mat,
  BPPARAM = BiocParallel::SerialParam(progressbar = TRUE),
  return_all = FALSE
)
}
\arguments{
\item{exprs_mat}{Numeric matrix (genes Ã— samples). Values must be >= 0.}

\item{BPPARAM}{BiocParallel parameter object; default uses SerialParam.}

\item{return_all}{Logical; if TRUE, returns extra columns including zeros for
all input genes (not only filtered genes).}
}
\value{
If \code{return_all = FALSE} (default) a data.frame with rows for
genes that passed the zero-filter and columns: bgIdx, rho, sigma, mu,
mu.scaled, zero. If \code{return_all = TRUE} returns a data.frame with one
row per input gene including zero fraction.
}
\description{
Internal function used to identify genes that are stably low (background)
across samples. The function fits a two-component Normal/Gamma mixture model
(EM) to non-zero expression values per gene and combines three stability
features into a single \code{bgIdx} score.
}
\details{
Steps:
\enumerate{
\item Compute fraction of zeros per gene and remove genes with >80\% zeros.
\item For remaining genes, fit a 2-component Normal/Gamma mixture (zeroes
removed) using \code{gammaNormMix} in parallel.
\item Combine scaled mixture parameters (rho, sigma, mu) and zero fraction
into a composite background index \code{bgIdx} (higher = more background-like).
}
}
\keyword{internal}
