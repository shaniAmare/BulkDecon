% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_bgindex.R
\name{gammaNormMix}
\alias{gammaNormMix}
\title{Fit a 2-component Normal/Gamma mixture to a vector of values (EM)}
\usage{
gammaNormMix(
  data,
  thresh = 1e-07,
  maxiter = 10000,
  removeZeroes = TRUE,
  plot = TRUE,
  hist = TRUE,
  hist_col = "light cyan",
  verbose = FALSE,
  forceExponential = FALSE,
  calculateAreaDifference = FALSE,
  minDataPoints = 5,
  onlyAddCurves = FALSE,
  addContextData = FALSE,
  contextData = NULL
)
}
\arguments{
\item{data}{numeric vector}

\item{thresh}{convergence threshold}

\item{maxiter}{maximum iterations}

\item{removeZeroes}{whether to remove zero values before EM}

\item{plot}{logical; whether to plot diagnostics (default FALSE in compute wrapper)}

\item{verbose}{logical}
}
\value{
list with elements probExpressed, propExpressed, numExpressed, mu, sd, alpha, beta, rho, niter, loglik, BIC, AIC, ICL_BIC, AreaDifference
}
\description{
This function fits a mixture model to non-zero values and returns a list
with probExpressed (per-observation posterior) and model parameters.
It attempts to reproduce the original behaviour but is more defensive and
will fall back gracefully where packages are unavailable.
}
\keyword{internal}
