% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mergeTumorIntoX.R
\name{mergeTumorIntoX}
\alias{mergeTumorIntoX}
\title{Merge Tumor Profiles Into a Reference Matrix}
\usage{
mergeTumorIntoX(norm, bg, pure_tumor_ids, X)
}
\arguments{
\item{norm}{A numeric matrix of normalized expression values. Rows = genes,
columns = AOIs or samples.}

\item{bg}{A numeric matrix of background estimates, same dimensions as \code{norm}.}

\item{pure_tumor_ids}{A character vector of column names (or indices)
indicating tumor-only samples to use in constructing tumor profiles.}

\item{X}{A reference profile matrix (e.g., cell type signatures) with genes
as rows and reference profiles as columns.}
}
\value{
A matrix combining the original reference profiles and new tumor
profiles. Gene order is preserved among shared genes.
}
\description{
This function takes a normalized expression matrix (\code{norm}) and its
corresponding background matrix (\code{bg}), isolates pure tumor AOIs,
background-subtracts them, rescales tumor profiles to match the dynamic
range of the reference matrix \code{X}, and appends these tumor profiles to \code{X}.

The function is adapted from the Nanostring SpatialDecon workflow, but
streamlined for bulk RNA-seq deconvolution use cases.
}
\details{
Steps performed:
\enumerate{
\item Replace zeros with the minimum nonzero value.
\item Subset \code{norm} and \code{bg} to pure tumor AOIs.
\item Background-subtract tumor expression.
\item Align genes shared between tumor profiles and reference matrix \code{X}.
\item Rescale tumor profiles to have similar 90th-percentile expression as \code{X}.
\item Append tumor profiles to the reference matrix.
}
}
\examples{
\dontrun{
merged <- mergeTumorIntoX(norm = tumor_norm,
                          bg = tumor_bg,
                          pure_tumor_ids = c("Tumor1","Tumor2"),
                          X = reference_profiles)
}

}
