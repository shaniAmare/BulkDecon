% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/collapseCellTypes.R
\name{collapseCellTypes}
\alias{collapseCellTypes}
\title{Collapse Cell Types into Higher-Level Groups}
\usage{
collapseCellTypes(fit, matching)
}
\arguments{
\item{fit}{A deconvolution results list, typically containing
\code{beta}, and optionally \code{prop_of_all}, \code{prop_of_nontumor},
\code{sigmas}, and \code{X}.}

\item{matching}{A named list where each element is a character vector of
cell-type names to be collapsed. The names of the list become the
final collapsed categories.}
}
\value{
A modified copy of \code{fit} in which the relevant matrices
have been collapsed. Returns:
\describe{
\item{beta}{Collapsed abundance matrix.}
\item{prop_of_all}{Collapsed if present.}
\item{prop_of_nontumor}{Collapsed if present.}
\item{sigmas}{Collapsed covariance matrices if present.}
\item{se, t, p}{Recomputed standard errors, t-stats, and p-values
if covariance matrices are available.}
}
}
\description{
This function collapses cell-type–level deconvolution results into
broader categories by summing selected rows of the coefficient matrix
(\code{beta}) and—if present—related quantities such as
\code{prop_of_all}, \code{prop_of_nontumor}, and covariance matrices (\code{sigmas}).
}
\details{
The function creates a linear transformation matrix \eqn{A} that
aggregates the specified cell types. For example:
\preformatted{
matching = list(
    Immune = c("T_cells", "B_cells"),
    Stromal = c("Fibroblasts", "Endothelium")
)
}

produces a 2 × k matrix \eqn{A}, which is applied as:
\deqn{beta_collapsed = A \times beta}

If covariance arrays (\code{sigmas}) are supplied (2D or 3D), they are
transformed as:
\deqn{Σ' = A Σ A^T}
}
