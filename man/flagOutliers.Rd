% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flagOutliers.R
\name{flagOutliers}
\alias{flagOutliers}
\title{Identify Outlier Genes and Data Points from Reverse Deconvolution Residuals}
\usage{
flagOutliers(Y, yhat, resids, wts, resid_thresh = 3)
}
\arguments{
\item{Y}{Matrix of observed expression values (genes × samples).
Not directly used for filtering but kept for compatibility.}

\item{yhat}{Matrix of predicted expression values (genes × samples).}

\item{resids}{Matrix of residuals (observed - predicted, typically in log-space).}

\item{wts}{Optional numeric vector of weights.
If supplied, residuals are multiplied by these weights.
Length must be 1, nrow(resids), or ncol(resids).}

\item{resid_thresh}{Threshold on absolute weighted residuals to flag outliers.}
}
\value{
A list containing:
\describe{
\item{outlier_genes}{Logical vector (length = number of genes).
TRUE indicates that at least one sample was an outlier.}
\item{outlier_data_points}{Logical matrix (genes × samples) indicating individual outlier points.}
\item{weighted_residuals}{Matrix of weighted residuals used for detection.}
}
}
\description{
Flags outlier genes and individual data points based on weighted residuals
from reverse deconvolution or log-normal regression fits.
}
