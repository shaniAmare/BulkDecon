% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runbulkdecon.R
\name{runbulkdecon}
\alias{runbulkdecon}
\title{Run the BulkDecon workflow on bulk expression data}
\usage{
runbulkdecon(
  X = NULL,
  norm_elt = NULL,
  raw_elt = NULL,
  wts = NULL,
  resid_thresh = 3,
  lower_thresh = 0.5,
  align_genes = TRUE,
  is_pure_tumor = NULL,
  n_tumor_clusters = 10,
  cell_counts = NULL,
  cellmerges = NULL,
  maxit = 1000
)
}
\arguments{
\item{X}{Signature matrix (genes Ã— cell types).}

\item{norm_elt}{Normalized bulk expression matrix.}

\item{raw_elt}{Raw (unnormalized) bulk expression matrix.}

\item{wts}{Optional weights matrix (same dimensions as norm_elt).}

\item{resid_thresh}{Residual threshold for outlier filtering (log2 scale).}

\item{lower_thresh}{Lower bound for stabilized log2 residuals.}

\item{align_genes}{Logical; align genes by shared rownames (default TRUE).}

\item{is_pure_tumor}{Optional logical vector indicating tumor-pure samples.}

\item{n_tumor_clusters}{Integer; number of tumor clusters for pure-tumor mode.}

\item{cell_counts}{Optional vector of known cell counts per sample.}

\item{cellmerges}{Optional list describing merged cell type groups.}

\item{maxit}{Maximum number of iterations for deconvolution.}
}
\value{
A list returned by \code{bulkdecon()}, containing:
\itemize{
\item \code{beta}: estimated cell proportions
\item \code{sigmas}: covariance matrices
\item \code{p}: p-values
\item \code{t}: t-statistics
\item \code{se}: standard errors
\item \code{yhat}: fitted values
\item \code{resids}: residual matrix
}
}
\description{
This function runs the full BulkDecon pipeline using:
\itemize{
\item a normalized bulk expression matrix (\code{norm_elt})
\item a raw (unnormalized) bulk expression matrix (\code{raw_elt})
\item a single-cell or custom signature matrix (\code{X})
}
}
\details{
The function automatically:
\enumerate{
\item converts inputs to matrices
\item estimates background using \code{calc_background()}
\item runs \code{bulkdecon()} with the appropriate inputs
}
}
