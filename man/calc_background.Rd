% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_background.R
\name{calc_background}
\alias{calc_background}
\title{Calculate Background Expression from Stable Background Genes}
\usage{
calc_background(exprs_mat, norm)
}
\arguments{
\item{exprs_mat}{Numeric matrix of raw or normalized expression values.
Genes in rows, samples in columns.}

\item{norm}{Numeric matrix of normalized expression values with the same
dimensions and gene names as \code{exprs_mat}.}
}
\value{
A numeric matrix of background estimates with the same dimensions as
\code{exprs_mat}.
}
\description{
This function identifies background-stable genes using \code{calc_bgindex()},
selects high-stability genes, and uses them to estimate expected background
expression levels in bulk RNA-seq data. The resulting background matrix has
the same dimensions as \code{exprs_mat}.
}
\details{
Background-stable genes are defined using the \code{bgIdx} score produced by
\code{calc_bgindex()}. Genes ranked above the 80th percentile of the stability
index are considered background-like and used to compute per-sample background
using column means (on normalized data).
}
\examples{
\dontrun{
bg <- calc_background(exprs_mat = bulk_counts, norm = normalized_counts)
}
}
