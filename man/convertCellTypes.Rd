% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convertCellTypes.R
\name{convertCellTypes}
\alias{convertCellTypes}
\title{Collapse or Convert Cell Types Using a Linear Combination}
\usage{
convertCellTypes(beta, matching, stat = sum, na.rm = FALSE, sigma = NULL)
}
\arguments{
\item{beta}{A numeric matrix with cell types in rows and samples in columns.}

\item{matching}{A named list. Each element is a character vector of
row names from \code{beta} that should be grouped together. The list
names define the collapsed output rows.}

\item{stat}{(Unused; reserved for future functionality.) Default: \code{sum}.}

\item{na.rm}{Logical, whether to remove NAs (unused; included for API
compatibility).}

\item{sigma}{Optional covariance matrix or array. Can be:
\itemize{
\item a 2D covariance matrix (\eqn{k × k});
\item a 3D array of covariances (\eqn{k × k × n}).
}}
}
\value{
If \code{sigma} is missing, returns only the collapsed \code{beta} matrix.

If \code{sigma} is supplied, returns a list:
\describe{
\item{beta}{Collapsed abundance matrix.}
\item{sigma}{Collapsed covariance matrix or covariance array.}
}
}
\description{
This function collapses individual cell-type rows of a matrix (typically
\code{beta} from a deconvolution fit) into higher-level groups using a
user-specified grouping structure. Optionally, covariance matrices
(\code{sigma}) are transformed accordingly.
}
\details{
The function constructs a linear transformation matrix \eqn{A} whose rows
correspond to collapsed cell-type groups and whose columns match the
original cell types. The collapsed abundance matrix is computed as:

\deqn{beta' = A \, beta}

If covariance matrices are supplied, they are transformed as:

\deqn{Σ' = A \, Σ \, A^T}
}
